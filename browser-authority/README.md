# browser-authority

![openssl](https://www.gitcoins.io/assets/images/openssl-685ed43c9e0088918381ee7415177c98.png)

This lab to show you how authority of web browser works. Please give star if it helpful. 

## Generate server certificate

We will create the CA and server certificate which key type is rsa:4096. The detailed [source code](https://github.com/vulnsystem/OpensslCertificateVerify/browser-authority) have been push to this repository directory. Please star it when helpful. The CA and server certificates will generate after you run the **gen.sh**.

## Create a webpage
In this repository directory, there is a index.html file in the same directory as gen.sh. The webpage will be loaded when browser send a request from server.

## Start openssl server
To make a simple server, we can use openssl s_server command which implements a generic SSL/TLS server which listens for connections on a given port using SSL/TLS. Please issue the following command to start a TLS server.

```
openssl s_server -accept 20000 -cert server.cert -key server.key  -WWW -debug -tlsextdebug
```
The useful options in this command:
- accept: the optional TCP host and port to listen on for connections. If not specified, *:4433 is used.
- cert and key: the certificate and key of server are required, which have generated by gen.sh
- WWW: Emulates a simple web server. It is very useful. The pages will be resolved relative to the current directory, for example if the URL https://localhost:20000/index.html is requested the file ./index.html will be loaded. 
- debug and tlsextdebug: to show the detailed dump information of all traffic.

## Send request
After server started successfully, we can use browser to send a request as following. 

```
https://localhost:20000/index.html
```
**But security risk warning occur.** Because its certificate issuer is unknow and the server certificate created by ourself is not trusted by browser.
![firefox-security-warning](https://www.gitcoins.io/assets/images/firefox-security-warning-4916137e0328cdb63b5560e1e7c286b1.png)

There are two ways to open the index
- Click **Advanced...** buttom and **Accept the Risk and Continue**
- Add the CA certificate which sign the server certificate in the certificate manager of browser.

> After CA ceritificate added in the manager, the browser will trust all the server's certificate which signed by the CA's.

## Add server cert in the manager
You can found the certificate manager is located at **about:preferences#privacy** in the firefox. And import the CA's cert to the manager.
![firefox-security-warning](https://www.gitcoins.io/assets/images/firefox-certificate-manager-e23623ff1b4afa3c3b4472c120195b4c.png)

## index.html loaded
There is **Hello World** in the webpage.

## More details
The detailed information have been published in [gitcoins.io](https://www.gitcoins.io/docs/next/browser-authority). 
